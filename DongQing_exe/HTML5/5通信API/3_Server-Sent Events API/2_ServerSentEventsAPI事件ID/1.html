<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Server-Sent Events API使用示例</title>
<script type="text/javascript">
    var source;

    function connectSSE() {
        if (typeof(EventSource) !== "undefined") {
            // 创建 EventSource 实例，连接到 /sse 路径
            source = new EventSource("/sse");

            // 处理默认消息事件
            source.onmessage = function(event) {
                console.log('Last Event ID:', event.lastEventId); // 打印事件ID
                document.getElementById("result").innerHTML += event.data + "<br />";
            };

            // 处理错误事件
            source.onerror = function(event) {
                console.error('SSE error:', event);
            };
        } else {
            document.getElementById("result").innerHTML = "对不起,您的浏览器不支持Server-Sent Events API!";
        }
    }

    // 页面加载完成后建立连接
    window.addEventListener('load', connectSSE);
</script>
</head>
<body>
<h1>Server-Sent Events API使用示例</h1>
<div id="result"></div>
</body>
</html>